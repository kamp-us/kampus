## 2026-01-18: Add ReaderContent/ReaderResult GraphQL types (task-1)

Files changed:
- apps/worker/src/graphql/schema.ts

Changes:
- Added ReaderContentType with fields: title, content, byline, siteName, wordCount, readingTimeMinutes, excerpt
- Added ReaderResultType with fields: readable, content, error
- Types placed after UrlMetadataType, before Node interface section

Verified:
- tsc --noEmit passes

## 2026-01-18: Extend WebPageParserClient with getReaderContent (task-2)

Files changed:
- apps/worker/src/graphql/resolvers/WebPageParserClient.ts

Changes:
- Added ReaderContent and ReaderResult interfaces
- Added getReaderContent() method that calls client.getReaderContent({}) RPC
- Method returns mapped result matching interface shape

Verified:
- turbo run typecheck passes

## 2026-01-18: Add readerContent field to Story GraphQL type (task-3)

Files changed:
- apps/worker/src/graphql/schema.ts

Changes:
- Added readerContent field to StoryType
- Resolver uses CloudflareEnv, WebPageParserClient.make(env, story.url)
- Returns ReaderResultType (non-null)

Verified:
- turbo run typecheck passes

## 2026-01-18: Frontend implementation (task-4, task-5, task-6, task-7, task-8)

Files changed:
- apps/kamp-us/src/pages/library/ReaderPage.tsx (new)
- apps/kamp-us/src/pages/library/ReaderPage.module.css (new)
- apps/kamp-us/src/main.tsx (route added)
- apps/kamp-us/src/pages/Library.tsx (StoryRow updated)
- apps/kamp-us/schema.graphql (fetched updated schema)
- apps/kamp-us/src/__generated__/ReaderPageQuery.graphql.ts (generated)

Changes:
- Created ReaderPage component with ReaderPageQuery GraphQL query
- Split into ReaderPageContent (param validation) and ReaderPageContentInner (data fetching)
- NotFound, NotReadable, ReaderSkeleton components for error/loading states
- CSS uses ch/rem units, 75ch max-width for readable typography
- Added route /me/library/:storyId after /me/library/tags
- StoryRow title now uses <Link> to reader page instead of <a> to external URL
- Added "View original" menu item that opens story.url in new tab

Decisions:
- Used wrapper component pattern to avoid hook-before-conditional-return issue
- Added biome-ignore for dangerouslySetInnerHTML (content from Readability is sanitized)
- Removed :global() CSS syntax; biome doesn't support it, used plain descendant selectors

Verified:
- turbo run typecheck passes
- biome check passes
- Playwright tests: library links work, reader page loads, not-found/not-readable states work, back navigation works

## 2026-01-18: Shiki syntax highlighting (task-8, task-9, task-10, task-11)

Files changed:
- apps/kamp-us/package.json (shiki dependency added)
- apps/kamp-us/src/utils/highlightCode.ts (new)
- apps/kamp-us/src/pages/library/ReaderPage.tsx (updated)

Changes:
- Installed shiki for syntax highlighting
- Created highlightCodeBlocks utility that parses HTML, finds pre>code elements, and applies Shiki highlighting
- Integrated highlighting in ReaderPage via useState + useEffect pattern
- Renders highlightedContent when ready, falls back to original content

Decisions:
- No default language: skip highlighting if no language class/attr detected (wrong colors worse than no colors)
- Theme: github-dark for contrast with light reader background
- Check both class="language-*" and data-lang attribute

Verified:
- turbo run typecheck passes
- biome check passes
- Playwright: code blocks render with syntax highlighting (colors visible for keywords, functions, JSX tags)
